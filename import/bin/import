#!/usr/bin/env ruby
topdir = File.expand_path("../..", File.dirname(__FILE__))
modeldir = File.join(topdir, "app/models")
$LOAD_PATH.unshift modeldir

importfilesdir = File.join(topdir, "import/import-files")
$LOAD_PATH.unshift importfilesdir

libdir = File.join(topdir, "lib")
$LOAD_PATH.unshift libdir

importdir = File.join(topdir, "import")
$LOAD_PATH.unshift importdir

require 'rubygems'
require 'sqlite3'
require 'active_record'
require 'nokogiri'
require 'open-uri'
require 'util-ar'
require 'importer'


xml_file = ARGV[0]
project_id = ARGV[1]
db_url = ARGV[2]
am_testing = true


DB = ActiveRecord::Base.establish_connection(
 :adapter => "sqlite3",
 :database  => topdir + "/db/development.sqlite3")


sc_id = Aurora.import(open(xml_file),project_id, {:is_new => false , :am_testing => am_testing})

p xml_file
